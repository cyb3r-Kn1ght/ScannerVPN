# Xoá pod/job scanner node theo job_id (không xóa DB)
@app.delete("/api/scan_jobs/{job_id}/scanner_job")
def delete_scanner_job_only(job_id: str, db: Session = Depends(get_db)):
    job = db.query(models.ScanJob).filter(models.ScanJob.job_id == job_id).first()
    if not job:
        raise HTTPException(status_code=404, detail="Scan job not found")
    scanner_job = getattr(job, "scanner_job_name", None)
    if not scanner_job:
        raise HTTPException(status_code=404, detail="No scanner_job_name found for this job")
    scanner_node_url = os.getenv("SCANNER_NODE_URL", "http://scanner-node-api:8000")
    try:
        resp = httpx.delete(f"{scanner_node_url}/api/scanner_jobs/{scanner_job}", timeout=10)
        if resp.status_code == 404:
            resp_json = {"status": "not found"}
        elif resp.status_code == 200:
            resp_json = resp.json()
        else:
            resp_json = {"error": resp.text}
    except Exception as e:
        resp_json = {"error": str(e)}
    logger.info(f"Called scanner node to delete {scanner_job} for job {job_id}")
    return {"status": "scanner_job_deleted", "job_id": job_id, "scanner_job": scanner_job, "scanner_node_response": resp_json}